(()=>{var e={};e.id=759,e.ids=[759],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7462:(e,t,r)=>{"use strict";r.d(t,{HP:()=>o,ll:()=>n});var s=r(88909);let a=process.env.DATABASE_URL,n=a?(0,s.lw)(a):null,o=!a},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},41098:(e,t,r)=>{"use strict";r.d(t,{BE:()=>p,Er:()=>d,HU:()=>u,ZT:()=>E,oC:()=>l});var s=r(87806),a=r(77412),n=r(85663);let o=process.env.JWT_SECRET||"demo-secret-key-not-for-production-use-only",i=new TextEncoder().encode(o);async function u(e,t,r){return await new s.P({userId:e,email:t,role:r}).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("7d").sign(i)}async function c(e){try{let{payload:t}=await (0,a.V)(e,i);return t}catch(e){return null}}async function d(e){let t=await n.Ay.genSalt(10);return n.Ay.hash(e,t)}async function p(e,t){return n.Ay.compare(e,t)}async function l(e){let t=e.headers.get("authorization");if(!t||!t.startsWith("Bearer "))return{error:"N\xe3o autorizado",status:401};let r=t.substring(7),s=await c(r);return s?{user:s}:{error:"Token inv\xe1lido",status:401}}async function E(e){let t=await l(e);return"error"in t?t:"admin"!==t.user.role?{error:"Acesso negado. Apenas administradores.",status:403}:{user:t.user}}process.env.JWT_SECRET},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},49552:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>x,routeModule:()=>p,serverHooks:()=>m,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>E});var s={};r.r(s),r.d(s,{GET:()=>d});var a=r(96559),n=r(48088),o=r(37719),i=r(32190),u=r(7462),c=r(41098);async function d(e){if(u.HP)return console.log("[DEMO MODE] GET /api/admin/stats - retornando estat\xedsticas simuladas"),i.NextResponse.json({totalProducts:8,totalOrders:0,totalRevenue:0,pendingOrders:0,recentOrders:[],demoMode:!0,message:"Estat\xedsticas em modo demonstra\xe7\xe3o"});let t=await (0,c.ZT)(e);if("error"in t)return i.NextResponse.json({error:t.error},{status:t.status});try{let e=await (0,u.ll)`
      SELECT COUNT(*) as count FROM products WHERE active = true
    `,t=Number(e[0]?.count||0),r=await (0,u.ll)`
      SELECT COUNT(*) as count FROM orders
    `,s=Number(r[0]?.count||0),a=await (0,u.ll)`
      SELECT COALESCE(SUM(total), 0) as revenue
      FROM orders
      WHERE payment_status = 'paid'
    `,n=Number(a[0]?.revenue||0),o=await (0,u.ll)`
      SELECT COUNT(*) as count 
      FROM orders 
      WHERE status = 'pending'
    `,c=Number(o[0]?.count||0);return i.NextResponse.json({totalProducts:t,totalOrders:s,totalRevenue:n,pendingOrders:c})}catch(e){return console.error("Error fetching stats:",e),i.NextResponse.json({error:"Failed to fetch statistics"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/admin/stats/route",pathname:"/api/admin/stats",filename:"route",bundlePath:"app/api/admin/stats/route"},resolvedPagePath:"/workspaces/Print3D/app/api/admin/stats/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:l,workUnitAsyncStorage:E,serverHooks:m}=p;function x(){return(0,o.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:E})}},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,368,987],()=>r(49552));module.exports=s})();